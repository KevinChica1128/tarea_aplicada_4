eigen(t(X)%*%X)
ki
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$1
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$X[1]
eigen(t(X)%*%X)
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[1]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[4]
#ANALISIS DE VALORES PROPIOS
as.factor(eigen(t(X)%*%X))
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[1]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[2]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[3]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[4]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[5]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[6]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[7]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[7]
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)$values[8]
max(eigen(t(X)%*%X)$values)
min(eigen(t(X)%*%X)$values)
ki
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
regresion_pcr=pcr(formula=cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
#METODO (PCR) componentes principales
install.packages("pls")
library(pls)
regresion_pcr=pcr(formula=cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(regresion_pcr)
#Determinante de la matriz de correlaciones:
det(R)
det(t(X)%*%X)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x7<-x1^2
x8<-x2^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
cor(X)
cor(X)
x1
R<-t(X)%*%X
cor(R)
cor(X)
x4
X
cor(X)
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x7<-x1^2
x8<-x2^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
cor(X)
x11<-(x1-mean(x1))/(sum(x1^2)-length(x1)*mean(x1)^2)
x11
sum(x1^2)
x11<-(x1-mean(x1))/(sum(x1^2)-(length(x1)*mean(x1)^2))
x11
x11<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
x11
x11<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
x22<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
x33<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
x44<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
x55<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
x66<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
x77<-(x7-mean(x7))/sqrt(sum(x7^2)-(length(x7)*mean(x7)^2))
x88<-(x8-mean(x8))/sqrt(sum(x8^2)-(length(x8)*mean(x8)^2))
x99<-(x9-mean(x9))/sqrt(sum(x9^2)-(length(x9)*mean(x9)^2))
X1<-cbind(x11,x22,x33,x44,x55,x66,x77,x88,x99)
Z<-t(X1)%*%X1
Z
cor(X)
cor(X)
Z
x11
x22
x33
x44
x1*x2
x1
x2
eigen(Z)
eigen(X)
eigen(R)
V<-eigen(R)$vectors
V
Z<-X%*%V
Z
t(Z)%*%Z
X1<-cbind(x11,x22,x33,x44,x55,x66,x77,x88,x99)
P<-t(X1)%*%X1
P
eigen(P)
eigen(cor(R))
cor(R)
P
cor(X)
V<-eigen(X)$vectors
V
V<-eigen(R)$vectors
V
V<-eigen(R)
V
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x7<-x1^2
x8<-x2^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
cor(X)
R<-t(X)%*%X
V<-eigen(R)
Z<-X%*%V
#Variables estandarizadas:
x11<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
x22<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
x33<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
x44<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
x55<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
x66<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
x77<-(x7-mean(x7))/sqrt(sum(x7^2)-(length(x7)*mean(x7)^2))
x88<-(x8-mean(x8))/sqrt(sum(x8^2)-(length(x8)*mean(x8)^2))
x99<-(x9-mean(x9))/sqrt(sum(x9^2)-(length(x9)*mean(x9)^2))
X1<-cbind(x11,x22,x33,x44,x55,x66,x77,x88,x99)
P<-t(X1)%*%X1
eigen(P)
Y<-c(49,50.2,50.5,48.5,47.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
X1<-c(rep(c(1300,1200,1100),c(6,6,4)))
X1
X2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
X3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260,0.0340,
0.0410,0.0840,0.0980,0.0920,0.0860)
X4<-X1*X2
X5<-X1*X3
X6<-X2*X3
X7<-X1^2
X8<-X2^2
X9<-X3^2
X<-cbind(X1,X2,X3,X4,X5,X6,X7,X8,X9)
X
cor(X)
cadata <- read.csv("~/GitHub/tarea_aplicada_4/cadata.txt", sep="")
## El número aleatorio generado fue 15529 ##
# Eliminamos las filas que no necesitamos, nos quedamos con las filas desde la 15529 hasta la 16029 #
cadata<- cadata[-c(1:15528,16029:20640),]
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
#Valors ajustados y residuales del modelo:
yajustados<-fitted(Regresion)
residuales<-residuals(Regresion)
#Matriz de correlaciones:
X = cbind(Ingreso=cadata$Ingreso_mediano,Edad=cadata$Edad_mediana_de_la_vivienda,Habitaciones=cadata$Total_de_habitaciones,
Dormitorios=cadata$Total_de_dormitorios,Poblacion=cadata$Poblacion,Hogares=cadata$Hogares,Latitud=cadata$Latitud,Longitud=cadata$Longitud)
R = cor(X)
R
#Factor de inflación de varianza:
library('fmsb')
#Ingreso:
modi<-lm(cadata$Ingreso_mediano ~ cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(modi)
VIF(modi)   #Paquete
Ri2=0.3613       #A mano
VIFi=(1-Ri2)^(-1)
#Edad:
mode<-lm(cadata$Edad_mediana_de_la_vivienda ~ cadata$Ingreso_mediano+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
VIF(mode)   #Paquete
Re2=0.2136       #A mano
summary(mode)
#Habitaciones:
modh<-lm(cadata$Total_de_habitaciones ~ cadata$Edad_mediana_de_la_vivienda+cadata$Ingreso_mediano+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
VIFe=(1-Re2)^(-1)
summary(modh)
VIF(modh)   #Paquete
Rh2=0.8781       #A mano
VIFh=(1-Rh2)^(-1)
#Dormitorios:
modd<-lm(cadata$Total_de_dormitorios ~ cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Ingreso_mediano+cadata$Poblacion+cadata$Hogares)
summary(modd)
VIF(modd)   #Paquete
Rd2=0.9809       #A mano
VIFd=(1-Rd2)^(-1)
#Población:
modp<-lm(cadata$Poblacion ~ cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Ingreso_mediano+cadata$Hogares)
summary(modp)
VIF(modp)   #Paquete
Rp2=0.8238       #A mano
VIFp=(1-Rp2)^(-1)
#Hogares:
modho<-lm(cadata$Hogares ~ cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Ingreso_mediano+cadata$Poblacion)
summary(modho)
VIF(modho)   #Paquete
Rho2=0.9822       #A mano
VIFho=(1-Rho2)^(-1)
#ANALISIS DE VALORES PROPIOS
eigen(t(X)%*%X)
k=max(eigen(t(X)%*%X)$values)/min(eigen(t(X)%*%X)$values)
ki=c(max(eigen(t(X)%*%X)$values)/eigen(t(X)%*%X)$values)
#METODO (PCR) componentes principales
install.packages("pls")
install.packages("pls")
library(pls)
regresion_pcr=pcr(formula=cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(regresion_pcr)
#Determinante de la matriz de correlaciones:
det(R)
#Método (PCR) paso a paso:
#La matriz X es:
X
#La matriz X* (reescalada) es:
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
x5<-cadata$Poblacion
x6<-cadata$Hogares
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
Xr
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
Rr
R
T<-eigen(Rr)$vectors
T
Z<-Xr%*%T
Z
t(Z)%*%Z
Z<-X%*%T
#Método (PCR) paso a paso:
#La matriz X es:
X
Z<-X%*%T
R = cor(X)
R
#Matriz de correlaciones:
X = cbind(Ingreso=cadata$Ingreso_mediano,Edad=cadata$Edad_mediana_de_la_vivienda,Habitaciones=cadata$Total_de_habitaciones,
Dormitorios=cadata$Total_de_dormitorios,Poblacion=cadata$Poblacion,Hogares=cadata$Hogares)
R = cor(X)
R
Z<-X%*%T
t(Z)%*%Z
eigen(P)
Z<-Rr%*%T
Z
t(Z)%*%Z
eigen(Rr)
eigen(Rr)$vectors
t(T)%*%T
R<-t(X)%*%X
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x8<-x2^2
x7<-x1^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
cor(X)
R<-t(X)%*%X
V<-eigen(R)
Z<-X%*%V
V
V<-eigen(R)$vectors
Z<-X%*%V
Z
t(Z)%*%Z
cadata <- read.csv("~/GitHub/tarea_aplicada_4/cadata.txt", sep="")
## El número aleatorio generado fue 15529 ##
# Eliminamos las filas que no necesitamos, nos quedamos con las filas desde la 15529 hasta la 16029 #
cadata<- cadata[-c(1:15528,16029:20640),]
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
#Valors ajustados y residuales del modelo:
yajustados<-fitted(Regresion)
residuales<-residuals(Regresion)
#Matriz de correlaciones:
X = cbind(Ingreso=cadata$Ingreso_mediano,Edad=cadata$Edad_mediana_de_la_vivienda,Habitaciones=cadata$Total_de_habitaciones,
Dormitorios=cadata$Total_de_dormitorios,Poblacion=cadata$Poblacion,Hogares=cadata$Hogares)
R = cor(X)
R
#La matriz X* (reescalada) es:
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
x5<-cadata$Poblacion
x6<-cadata$Hogares
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
Rr
eigen(Rr)
T<-eigen(Rr)$vectors
Z<-Rr%*%T
t(Z)%*%Z
t(Z)%*%Z
Z%*%t(Z)
T%*%t(T)
t(T)%*%(t(Rr)%*%Rr)%*%T
eigen(Rr)
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x7<-x1^2
x8<-x2^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
R<-t(X)%*%X
x1<-c(1,0.224,-0.958,-0.132,0.443,0.205,-0.271,0.031,-0.577)
x3<-c(-0.958,-0.240,1,0.194,-0.661,-0.274,0.501,-0.018,0.765)
x4<-c(-0.132,0.039,0.194,1,-0.265,-0.975,0.246,0.398,0.274)
x6<-c(0.205,-0.023,-0.274,-0.975,0.323,1,-0.279,-0.374,0.358)
x5<-c(0.443,0.192,-0.661,-0.265,1,0.323,-0.972,0.126,-0.972)
x7<-c(-0.271,-0.148,0.501,0.246,-0.972,-0.279,1,-0.124,0.874)
x2<-c(0.224,1,-0.240,0.039,0.192,-0.023,-0.148,0.498,-0.224)
x8<-c(0.031,0.498,-0.018,0.398,0.126,-0.374,-0.124,1,-0.158)
XtXc=rbind(x1,x2,x3,x4,x5,x6)
x9<-c(-0.577,-0.224,0.765,0.274,-0.972,0.358,0.874,-0.158,1)
XtXc
XtXc=rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
XtXc
eigen(XtXc)
eigen(XtXc)
XtXc=rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
XtXc
y<-c(49,50.2,50.5,48.5,47.5,44.5,44.5,28,31.5,34.5,35,38,38.5,15,17,20.5,29.5)
x2<-c(7.5,9,11,13.5,17,23,5.3,7.5,11,13.5,17,23,5.3,7.5,11,17)
x1<-c(rep(1300,6),rep(1200,6),rep(1100,4))
x3<-c(0.0120,0.0120,0.0115,0.0130,0.0135,0.0120,0.0400,0.0380,0.0320,0.0260
,0.0340,0.0410,0.0840,0.0980,0.0920,0.0860)
x4<-x1*x2
x5<-x1*x3
x6<-x2*x3
x7<-x1^2
x8<-x2^2
x9<-x3^2
X<-cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
cor(X)
R<-t(X)%*%X
V<-eigen(R)$vectors
V
#Variables estandarizadas:
x11<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
x22<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
x33<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
x44<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
x66<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
x55<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
x77<-(x7-mean(x7))/sqrt(sum(x7^2)-(length(x7)*mean(x7)^2))
x88<-(x8-mean(x8))/sqrt(sum(x8^2)-(length(x8)*mean(x8)^2))
x99<-(x9-mean(x9))/sqrt(sum(x9^2)-(length(x9)*mean(x9)^2))
X1<-cbind(x11,x22,x33,x44,x55,x66,x77,x88,x99)
P<-t(X1)%*%X1
eigen(P)
cadata <- read.csv("~/GitHub/tarea_aplicada_4/cadata.txt", sep="")
## El número aleatorio generado fue 15529 ##
# Eliminamos las filas que no necesitamos, nos quedamos con las filas desde la 15529 hasta la 16029 #
cadata<- cadata[-c(1:15528,16029:20640),]
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
#Valors ajustados y residuales del modelo:
yajustados<-fitted(Regresion)
residuales<-residuals(Regresion)
#Matriz de correlaciones:
X = cbind(Ingreso=cadata$Ingreso_mediano,Edad=cadata$Edad_mediana_de_la_vivienda,Habitaciones=cadata$Total_de_habitaciones,
Dormitorios=cadata$Total_de_dormitorios,Poblacion=cadata$Poblacion,Hogares=cadata$Hogares)
eigen(Rr)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
x5<-cadata$Poblacion
x6<-cadata$Hogares
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
eigen(Rr)
cadata
cadata <- read.csv("~/GitHub/tarea_aplicada_4/cadata.txt", sep="")
## El número aleatorio generado fue 15529 ##
# Eliminamos las filas que no necesitamos, nos quedamos con las filas desde la 15529 hasta la 16029 #
cadata<- cadata[-c(1:15528,16029:20640),]
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
#Valors ajustados y residuales del modelo:
yajustados<-fitted(Regresion)
residuales<-residuals(Regresion)
#Matriz de correlaciones:
X = cbind(Ingreso=cadata$Ingreso_mediano,Edad=cadata$Edad_mediana_de_la_vivienda,Habitaciones=cadata$Total_de_habitaciones,
Dormitorios=cadata$Total_de_dormitorios,Poblacion=cadata$Poblacion,Hogares=cadata$Hogares)
R = cor(X)
R
#La matriz X* (reescalada) es:
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
x5<-cadata$Poblacion
x6<-cadata$Hogares
#La matriz X* (reescalada) es:
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
x5<-cadata$Poblacion
x6<-cadata$Hogares
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
Rr
R
R
Rr
eigen(Rr)
T<-eigen(Rr)$vectors
T
Xr%*%T
Z<-Xr%*%T
Z
t(Z)%*%Z
eigen(Rr)$values
T
eigen(Rr)
