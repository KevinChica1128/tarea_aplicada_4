V<-(1/sum(w))*(sum(w*p^2))
V
w*p^2
w
p
E<-(1/sum(w))*(sum(w*p))
E
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/pnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
#Función de importancia uniforme(0,1):
p2<-runif(m,0,1)
w2<-h(p2)/punif(p2,0,)
E2<-(1/sum(w2))*(sum(w2*p2))
E2
E
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)}
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/pbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
E00
V00<-(1/sum(w00))*(sum(w00*p00^2))
V00
#Función de importancia normal
p11<-rnorm(m,0.6268,0.002649)
w11<-h1(p11)/pnorm(p11,0.6268,0.002649)
E11<-(1/sum(w11))*(sum(w11*p11))
E11
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/pnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))
E11
#Función de importancia uniforme(0,1):
p22<-runif(m,0,1)
w22<-h1(p22)/punif(p22,0,1)
E22<-(1/sum(w22))*(sum(w22*p22))
E22
integrate(h,0,1)
integrate(h,0,1,subdivisions = 100)
x11()
plot(p,h(p))
plot(p1,h(p1))
x11()
plot(p,h(p))
x11()
plot(p,h(p))
x11()
plot(p1,h(p1))
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
integrate(h,0,1,subdivisions = 100)
#Función de importancia Beta
p<-rbeta(m,1,1)
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/pbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*p^2))
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/pnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
#Función de importancia uniforme(0,1):
p2<-runif(m,0,1)
w2<-h(p2)/punif(p2,0,)
E2<-(1/sum(w2))*(sum(w2*p2))
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)}
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/pbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
V00<-(1/sum(w00))*(sum(w00*p00^2))
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/pnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))
#Función de importancia uniforme(0,1):
p22<-runif(m,0,1)
w22<-h1(p22)/punif(p22,0,1)
E22<-(1/sum(w22))*(sum(w22*p22))
x11()
plot(p,h(p))
x11()
plot(density(h(p))
x11()
plot(density(h(p))
x11()
plot(density(h(p)))
x11()
plot(density(h(p)))
x11()
plot(density(h(p)),xlim=c(0,1))
x11()
plot(density(h(p)))
x11()
plot(density(h(p)),xlim=c(0,50))
x11()
plot(p1,h(p1))
x11()
plot(density(h(p1)))
x11()
plot(p1,h(p1))
x11()
plot(p,h(p))
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
#Función de importancia Beta
p<-rbeta(m,1,1)
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/pbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*p^2))
E
V
p
p^2
w*p
sum(w*p)
sum(w*p^2)
w*p^2
w
h(p)
p
h(p)
w*p
w
p
w*p
V<-(1/sum(w))*(sum(w*(p^2)))
V
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*(p^2)))
E
V
w<-h(p)/qbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*(p^2)))
E
V
w<-h(p)/pbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*(p^2)))
E
V
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*(p^2)))
E
V
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
w1<-h(p1)/pnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
w1<-h(p1)/qnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
V1<-(1/sum(w1))*(sum(w1*(p1^2)))
V1
exac<-runif(1000,0,1)
exac<-runif(m,0,1)
sum(h(exac))/m
integrate(h,0,1)
x11()
plot(p,h(p))
integrate((x^6)*(1-x)^9,0,1)
funcion<-function(x){(x^6)*(1-x)^9}
integrate(funcion,0,1)
set.seed(0)
x <- rexp(1000)  ## samples from proposal density
x <- rexp(1000)  ## samples from proposal density
f <- function(x) {2 * x *exp(-x^2)}  ## target density
w <- f(x) / dexp(x)  ## importance weights
Ef=(1/sum(w))*sum(w*x)
Ef
mean(w*x)
integrate(f,-inf,inf)
integrate(f,-lnf,lnf)
integrate(f,-infinity,infinity)
integrate(f,-Infinity,Infinity)
2/0
integrate(f,-Inf,Inf)
integrate(f*x,-Inf,Inf)
f <- function(x) {2 * x *exp(-x^2)*x}  ## target density
integrate(f,-Inf,Inf)
integrate(f,-Inf,Inf)
f <- function(x) {2 * x *exp(-x^2)}  ## target density
integrate(f,-Inf,Inf)
xbarra=mean(theta)
#--------------------------------------------------------#
N=1000
theta<-rnorm(1000)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
#--------------------------------------------------------#
N=1000
theta<-rnorm(1000)
xbarra=mean(theta)
xbarra
theta<-rnorm(1000)
xbarra=mean(theta)
xbarra
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
wi[i]<-dnorm(xbarra,thetaimpor[i],sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
w1=c()
w1=0
for (i in 1:N) {
w1[i]<-dnorm(xbarra,thetaimpor[i],sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
w1
(1/sum(w1))*sum(w1*thetaimpor)
promedio=t1/t2
promedio
xbarra
xbarra
p<-rt(N,N) #1
h<-function(x){dnorm(x,xbarra,sqrt(varianza))} #distribcion o funcion a posteriori
w<-h(p)/dbeta(p,1,1) #wi
E<-(1/sum(w))*(sum(w*p)) #Esperanza
E
w
h<-function(x){dnorm(xbarra,p,sqrt(varianza))} #distribcion o funcion a posteriori
w<-h(p)/dbeta(p,1,1) #wi
E<-(1/sum(w))*(sum(w*p)) #Esperanza
E
h
h(p)
N=1000
theta<-rnorm(1000)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(xbarra,thetaimpor[i],sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
(1/sum(w1))*sum(w1*thetaimpor)
xbarra
promedio
#--------------------------------------------------------#
N=10000
theta<-rnorm(10000)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(xbarra,thetaimpor[i],sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
thetaimpor
#--------------------------------------------------------#
N=10000
theta<-rnorm(10000)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(xbarra,thetaimpor[i],sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
#--------------------------------------------------------#
N=10000
theta<-rnorm(10000)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(thetaimpor[i],xbarra,sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
xbarra
theta<-rnorm(10000,10,1)
xbarra=mean(theta)
xbarra
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(thetaimpor[i],xbarra,sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
xbarra #Analitica
thetaimpor
#--------------------------------------------------------#
N=10000
theta<-rnorm(10000,10,1)
xbarra=mean(theta)
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(thetaimpor[i],xbarra,sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
theta<-rnorm(10000)
xbarra=mean(theta)
xbarra
varianza=1/N
thetaimpor<-rt(N,N)
t1=0
t2=0
w1=0
for (i in 1:N) {
w1[i]<-dnorm(thetaimpor[i],xbarra,sqrt(varianza))/dt(thetaimpor[i],N)
t2<-w1[i]+t2
t1<-thetaimpor[i]*w1[i]+t1
}
promedio=t1/t2 #Simulación
xbarra #Analitica
promedio
mean(theta)
N=10000
X<-rnorm(10000)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*p))
E
xbarra
E<-(1/sum(w))*(sum(w*thetai))
E
V<-(1/sum(w))*(sum(w*(thetai^2)))
V
varianza
xbarra
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
xbarra
varianza
E
V
X<-rnorm(N)
xbarra=mean(X)
xbarra
X<-rnorm(N)
xbarra=mean(X)
xbarra
varianza=1/N
varianza
set.seed(1)
X
xbarra
E
set.seed(1)
N=10000
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
xbarra
X<-rnorm(N)
set.seed(1)
X<-rnorm(N)
set.seed(1)
xbarra
N=10000
X<-rnorm(N)
xbarra=mean(X)
X<-rnorm(N)
xbarra=mean(X)
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
X<-rnorm(N,5,1)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
E
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
N=10000
X<-rnorm(N)
xbarra=mean(X)
N=10000
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
N=10000
X<-rnorm(N)
xbarra=mean(X)
X<-rnorm(N)
xbarra=mean(X)
varianza=1/N
thetai<-rt(N,N)
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N)
E<-(1/sum(w))*(sum(w*thetai))
V<-(1/sum(w))*(sum(w*(thetai^2)))
xbarra
E
V
xbarra
E
V
#Ejemplo 2:
funcion<-funcion(x){(x^9)*((1-x)^3)}
#Ejemplo 2:
funcion<-function(x){(x^9)*((1-x)^3)}
tetai<-runif(N)
w1<-funcion(tetai)/dunif(tetai)
E1<-(1/sum(w1))*(sum(w1*tetai))  #Esperanza estimada
V1<-(1/sum(w1))*(sum(w1*(tetai^2))) #Varianza estimada
E1
V1
